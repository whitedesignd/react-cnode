(this.webpackJsonpcnode=this.webpackJsonpcnode||[]).push([[8],{260:function(e,t,a){"use strict";a.r(t);var n=a(124),l=a(18),c=a.n(l),r=a(31),o=a(28),i=a(0),s=a.n(i),u=a(92),m=a(5),d=a(32),v=a(7),p=a(157),E=a.n(p),b=(a(253),a(6)),f=a.n(b),h=a(84);t.default=Object(v.b)((function(e){return{token:null===e||void 0===e?void 0:e.token}}))((function(e){var t=this,a=e.match,l=Object(i.useState)(),v=Object(o.a)(l,2),p=v[0],b=v[1],g=Object(i.useState)([]),k=Object(o.a)(g,2),N=k[0],_=k[1],j=Object(i.useState)(),y=Object(o.a)(j,2),O=y[0],C=y[1],x=Object(i.useContext)(d.a),w=(x.now,x.timeInterval),S=Object(i.useState)(),I=Object(o.a)(S,2),D=I[0],H=I[1],M=Object(i.useRef)();Object(i.useEffect)((function(){(function(){var t=Object(r.a)(c.a.mark((function t(){var n,l;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.a.get("/v1/topic/"+a.params.id,{params:{accesstoken:e.token}}).then((function(e){return e.data}));case 2:n=t.sent,l=n.data,b(l),_(l.replies),C(l.is_collect);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()(),H(E.a.createEditorState(""))}),[]);var T=Object(i.useCallback)((function(e){return e.currentTarget.scrollIntoView({behavior:"smooth"}),!1}),[]),F=Object(i.useCallback)((function(t,a){if(a.preventDefault(),!e.token)return alert("\u8bf7\u767b\u5f55");var l=N.findIndex((function(e){return e.id==t}));N[l].ups.includes(e.token)?N[l].ups.splice(N[l].ups.indexOf(e.token),1):N[l].ups.push(e.token),_(Object(n.a)(N))}),[]),L=[{key:"custom-button",type:"button",text:"\u9884\u89c8",onClick:function(){}}];return s.a.createElement(s.a.Fragment,null,p?s.a.createElement("div",{className:"header-router"},s.a.createElement("div",{className:"details-content router-content"},s.a.createElement("div",{className:"header topic_header"},s.a.createElement(u.a,{top:null===p||void 0===p?void 0:p.top,good:null===p||void 0===p?void 0:p.good,tab:null===p||void 0===p?void 0:p.tab}),s.a.createElement("div",{className:"topic_htitle"},null===p||void 0===p?void 0:p.title),s.a.createElement("div",{className:"changes"},s.a.createElement("span",null,"\u53d1\u5e03\u4e8e ",w(null===p||void 0===p?void 0:p.create_at)),s.a.createElement("span",null,"\u4f5c\u8005  ",s.a.createElement(m.b,{to:"/user/"+(null===p||void 0===p?void 0:p.author.loginname)},null===p||void 0===p?void 0:p.author.loginname)),s.a.createElement("span",null,null===p||void 0===p?void 0:p.visit_count," \u6b21\u6d4f\u89c8"),s.a.createElement("span",null,"\u6700\u540e\u4e00\u6b21\u7f16\u8f91\u662f ",w(null===p||void 0===p?void 0:p.last_reply_at)),s.a.createElement("span",null,"\u6765\u81ea ","ask"==(null===p||void 0===p?void 0:p.tab)?"\u95ee\u7b54":"\u5206\u4eab"),e.token&&s.a.createElement("div",{className:"collection"},s.a.createElement("button",{className:O?"cancel-collect":"collect-bt",onClick:function(t){t.preventDefault(),f.a.post("/v1/topic_collect/".concat(O?"de_collect":"collect"),{accesstoken:e.token,topic_id:p.id}).then((function(e){e.success&&C(!O)}))}},O?"\u53d6\u6d88\u6536\u85cf":"\u6536\u85cf")))),s.a.createElement("div",{className:"main",dangerouslySetInnerHTML:{__html:null===p||void 0===p?void 0:p.content}}),s.a.createElement("div",{className:"replies"},s.a.createElement("div",{className:"col_fade"},null===p||void 0===p?void 0:p.reply_count,"\u6761\u56de\u590d"),null===N||void 0===N?void 0:N.map((function(a,n){return s.a.createElement("div",{className:"cell",key:n},s.a.createElement("div",{className:" author_content"},s.a.createElement("div",{className:"reply-are"},s.a.createElement(m.b,{to:"/user/"+(null===a||void 0===a?void 0:a.author.loginname)},s.a.createElement("img",{src:a.author.avatar_url,alt:a.author.loginname,title:a.author.loginname})),s.a.createElement("div",{className:"use-info"},s.a.createElement(m.b,{to:"/user/"+(null===a||void 0===a?void 0:a.author.loginname)},null===a||void 0===a?void 0:a.author.loginname),s.a.createElement(m.b,{className:"reply_time",onClick:T,to:"#".concat(a.id)},"\u7b2c",n+1,"\u697c\u2022",w(a.create_at)))),e.token?s.a.createElement("div",{className:"reply-like"},s.a.createElement("span",{onClick:e.token?F.bind(t,a.id):""},"\ud83e\udd1e",a.ups.length)):s.a.createElement("div",{className:"reply-like",style:{display:a.ups.length>0?"block":"none"}},s.a.createElement("span",{onClick:e.token?F.bind(t,a.id):null},"\ud83e\udd1e",a.ups.length))),s.a.createElement("div",{className:"reply-content",dangerouslySetInnerHTML:{__html:a.content}}))}))),e.token&&s.a.createElement(s.a.Fragment,null,s.a.createElement("p",{className:"tip"},"\u6dfb\u52a0\u56de\u590d"),s.a.createElement("div",{className:"markdown_in_editor"},s.a.createElement(E.a,{value:D,controls:["bold","italic","underline","separator","media","letter-spacing","strikethrough","line-height","clear","subscript","hr","text-align","emojis"],extendControls:L,onChange:function(e){H(e.toHTML())}}),s.a.createElement("div",{className:"prew",ref:M}),s.a.createElement("div",{className:"reply-btn",onClick:function(e){e.preventDefault(),console.log(N[1]);var t={id:"5ee1f524b703280f0bcb9240"+Math.round(.5),author:{avatar_url:"https://avatars2.githubusercontent.com/u/14976489?v=4&s=120",loginname:"zy445566"},content:D,ups:Array(0),create_at:new Date};N.push(t),_(Object(n.a)(N)),H("")}},s.a.createElement("button",null,"\u56de\u590d"))))),p&&s.a.createElement(h.a,{author:p.author})):s.a.createElement("div",{className:"header-router",style:{backgroundColor:"#fff",height:"800px",width:"73%"}}))}))},84:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(29),l=a(0),c=a.n(l),r=a(7),o=a(5);a(85);function i(e){var t=Object(r.d)((function(e){return e})),a=t.token,l=t.personal;return e.author?c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"personal"},c.a.createElement("p",{style:{background:"#f6f6f6"}},"\u4f5c\u8005"),c.a.createElement("div",{className:"user-personal"},c.a.createElement("div",{className:"user-big-avatar"},c.a.createElement(o.b,{to:"/user/".concat(e.author.loginname)},c.a.createElement("img",Object(n.a)({src:e.author.avatar_url,alt:"",title:e.author.loginname},"alt",e.author.loginname))),c.a.createElement(o.b,{to:"/user/".concat(e.author.loginname)},c.a.createElement("p",null,e.author.loginname)))))):""!=a?c.a.createElement("div",{className:"personal"},c.a.createElement("p",{style:{background:"#f6f6f6"}},"\u4e2a\u4eba\u4fe1\u606f"),c.a.createElement("div",{className:"user-personal"},c.a.createElement("div",{className:"user-big-avatar"},c.a.createElement(o.b,{to:"/user/".concat(l.loginname)},c.a.createElement("img",Object(n.a)({src:l.avatar_url,alt:"",title:l.loginname},"alt",l.loginname))),c.a.createElement(o.b,{to:"/user/".concat(l.loginname)},c.a.createElement("p",null,l.loginname))))):c.a.createElement("div",{className:"personal-no"},c.a.createElement("p",null,"CNode\uff1aNode.js\u4e13\u4e1a\u4e2d\u6587\u793e\u533a"),c.a.createElement("p",{className:"tourist"},"\u5f53\u524d\u662f\u6e38\u5ba2\u72b6\u6001\uff0c\u60a8\u53ef\u4ee5 ",c.a.createElement("a",{href:"#/login"},"\u767b\u5f55")))}},85:function(e,t,a){},92:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(30),l=a(0),c=a.n(l);function r(e){var t={backgroundColor:"#80bd01",color:"#fff"},a={color:"#fff",fontSize:"12px",padding:"2px 4px",whiteSpace:"nowrap",lineHeight:1.5,margin:"0 5px",borderRadius:5};return e.top?c.a.createElement("span",{style:Object(n.a)({},a,{},t)},"\u7f6e\u9876"):e.good&&!e.top?c.a.createElement("span",{style:Object(n.a)({},a,{},t)},"\u7cbe\u534e"):c.a.createElement("span",{style:Object(n.a)({},a,{},{color:"#999",backgroundColor:"#e5e5e5"})},"ask"==e.tab?"\u95ee\u7b54":"\u5206\u4eab")}}}]);
//# sourceMappingURL=8.eef31a5f.chunk.js.map